23-05-16 15:47:33.572 - INFO:   name: INCA_JPEG_train_template
  use_tb_logger: True
  model: INCA
  scale: 2
  gpu_ids: [0]
  datasets:[
    train:[
      name: DIV2K
      mode: LQGT
      dataroot_GT: /data/fengxm/DIV2K/DIV2K_train_HR
      use_shuffle: True
      n_workers: 6
      batch_size: 2
      GT_size: 128
      use_flip: True
      use_rot: True
      color: RGB
      phase: train
      scale: 2
      data_type: img
    ]
    val:[
      name: val_DIV2K
      mode: LQGT
      dataroot_GT: /data/fengxm/DIV2K/DIV2K_valid_HR
      phase: val
      scale: 2
      data_type: img
    ]
  ]
  network:[
    wave_type: iwave
    subnet: learn_lifting97
    in_nc: 3
    out_nc: 3
    e_blocks: 5
    v_blocks: 3
    scale: 2
    gmm_components: 5
    init: xavier
  ]
  path:[
    pretrain_model: None
    strict_load: True
    resume_state: None
    root: /code/INCA
    experiments_root: /code/INCA/experiments/INCA_JPEG_train_template
    models: /code/INCA/experiments/INCA_JPEG_train_template/models
    training_state: /code/INCA/experiments/INCA_JPEG_train_template/training_state
    log: /code/INCA/experiments/INCA_JPEG_train_template
    val_images: /code/INCA/experiments/INCA_JPEG_train_template/val_images
  ]
  train:[
    use_diffcomp: True
    use_realcomp: True
    comp_format: JPEG
    comp_quality: 75
    lr: 0.0002
    beta1: 0.9
    beta2: 0.999
    niter: 500000
    warmup_iter: -1
    lr_scheme: MultiStepLR
    lr_steps: [100000, 200000, 300000, 400000]
    lr_gamma: 0.5
    pixel_criterion_forw: l2
    pixel_criterion_back: l1
    manual_seed: 10
    val_freq: 5000.0
    lambda_fit_forw: 16
    lambda_rec_back: 1
    lambda_fit_wave: 0.5
    lambda_fit_bicu: 0.0
    lambda_fit_real: 1.0
    weight_decay: 1e-05
    gradient_clipping: 10
  ]
  logger:[
    print_freq: 100
    save_checkpoint_freq: 5000.0
  ]
  is_train: True
  dist: False

23-05-16 15:47:33.780 - INFO: Random seed: 10
23-05-16 15:47:33.808 - INFO: Dataset [LQGTDataset - DIV2K] is created.
23-05-16 15:47:33.809 - INFO: Number of train images: 800, iters: 400
23-05-16 15:47:33.809 - INFO: Total epochs needed: 1250 for iters 500,000
23-05-16 15:47:33.812 - INFO: Dataset [LQGTDataset - val_DIV2K] is created.
23-05-16 15:47:33.812 - INFO: Number of val images in [val_DIV2K]: 100
23-05-16 15:47:35.936 - INFO: Network structure: DataParallel - WaveNet, with parameters: 38,367
23-05-16 15:47:35.936 - INFO: WaveNet(
  (haar_operations): ModuleList(
    (0): learn_wavelet(
      (lifting): learn_lifting97(
        (skip1): Conv2d(1, 1, kernel_size=(3, 1), stride=(1, 1), bias=False)
        (p_block1): P_block(
          (padding_reflect): ReflectionPad2d((1, 1, 1, 1))
          (conv_pre): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1))
          (res1): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (res2): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (conv_post): Conv2d(16, 1, kernel_size=(3, 3), stride=(1, 1))
        )
        (skip2): Conv2d(1, 1, kernel_size=(3, 1), stride=(1, 1), bias=False)
        (p_block2): P_block(
          (padding_reflect): ReflectionPad2d((1, 1, 1, 1))
          (conv_pre): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1))
          (res1): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (res2): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (conv_post): Conv2d(16, 1, kernel_size=(3, 3), stride=(1, 1))
        )
        (skip3): Conv2d(1, 1, kernel_size=(3, 1), stride=(1, 1), bias=False)
        (p_block3): P_block(
          (padding_reflect): ReflectionPad2d((1, 1, 1, 1))
          (conv_pre): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1))
          (res1): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (res2): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (conv_post): Conv2d(16, 1, kernel_size=(3, 3), stride=(1, 1))
        )
        (skip4): Conv2d(1, 1, kernel_size=(3, 1), stride=(1, 1), bias=False)
        (p_block4): P_block(
          (padding_reflect): ReflectionPad2d((1, 1, 1, 1))
          (conv_pre): Conv2d(1, 16, kernel_size=(3, 3), stride=(1, 1))
          (res1): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (res2): ResBlock(
            (padding): ReflectionPad2d((1, 1, 1, 1))
            (conv1): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
            (relu): ReLU()
            (conv2): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1))
          )
          (conv_post): Conv2d(16, 1, kernel_size=(3, 3), stride=(1, 1))
        )
      )
    )
  )
  (gmm): GaussianMixture()
)
23-05-16 15:47:35.960 - WARNING: Params [module.haar_operations.0.lifting.skip1.weight] will not optimize.
23-05-16 15:47:35.960 - WARNING: Params [module.haar_operations.0.lifting.skip2.weight] will not optimize.
23-05-16 15:47:35.960 - WARNING: Params [module.haar_operations.0.lifting.skip3.weight] will not optimize.
23-05-16 15:47:35.960 - WARNING: Params [module.haar_operations.0.lifting.skip4.weight] will not optimize.
23-05-16 15:47:35.961 - INFO: Model [INCA] is created.
23-05-16 15:47:35.962 - INFO: Start training from epoch: 0, iter: 0
23-05-16 15:48:51.773 - INFO: <epoch:  0, iter:     100, lr:2.000e-04> l_rec_all: 1.0741e+05 l_fit_wave: 5.3706e+04 l_fit_bicu: 0.0000e+00 l_real: 9.6910e+02 mu0: -5.6905e-05 pi0: -4.2868e-04 logvar0: -8.9219e-03 mu1: 2.1611e-04 pi1: -8.1883e-04 logvar1: -8.9704e-03 mu2: 5.4450e-05 pi2: -1.4965e-03 logvar2: -8.5389e-03 mu3: 9.8693e-04 pi3: 2.1752e-03 logvar3: -9.2515e-03 mu4: -1.7644e-04 pi4: 2.6740e-03 logvar4: -8.8793e-03 
23-05-16 15:50:02.481 - INFO: <epoch:  0, iter:     200, lr:2.000e-04> l_rec_all: 8.5394e+04 l_fit_wave: 4.2697e+04 l_fit_bicu: 0.0000e+00 l_real: 1.0369e+03 mu0: 9.6338e-03 pi0: -8.6096e-04 logvar0: -1.6917e-02 mu1: 1.0099e-02 pi1: -2.7654e-03 logvar1: -1.6700e-02 mu2: 1.1592e-02 pi2: -2.3152e-03 logvar2: -1.6390e-02 mu3: 1.2554e-02 pi3: 4.0450e-03 logvar3: -1.7769e-02 mu4: 1.0997e-02 pi4: 2.6321e-03 logvar4: -1.6738e-02 
23-05-16 15:51:12.225 - INFO: <epoch:  0, iter:     300, lr:2.000e-04> l_rec_all: 1.3270e+05 l_fit_wave: 6.6352e+04 l_fit_bicu: 0.0000e+00 l_real: 9.6711e+02 mu0: 2.0857e-02 pi0: -1.4686e-03 logvar0: -2.2250e-02 mu1: 2.0817e-02 pi1: -1.4515e-03 logvar1: -2.2282e-02 mu2: 2.3094e-02 pi2: -2.4908e-03 logvar2: -2.1547e-02 mu3: 2.3883e-02 pi3: 5.3454e-03 logvar3: -2.3286e-02 mu4: 2.2181e-02 pi4: 3.4798e-04 logvar4: -2.2087e-02 
23-05-16 15:52:18.146 - INFO: <epoch:  0, iter:     400, lr:2.000e-04> l_rec_all: 4.4367e+04 l_fit_wave: 2.2183e+04 l_fit_bicu: 0.0000e+00 l_real: 2.4725e+02 mu0: 3.5680e-02 pi0: -9.0635e-04 logvar0: -2.7479e-02 mu1: 3.5314e-02 pi1: -3.7918e-03 logvar1: -2.7006e-02 mu2: 3.7838e-02 pi2: -3.3908e-03 logvar2: -2.6260e-02 mu3: 3.9855e-02 pi3: 6.8360e-03 logvar3: -2.8705e-02 mu4: 3.8170e-02 pi4: 5.4447e-04 logvar4: -2.6844e-02 
